var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.useStripe=useStripe;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _types=require("../types");var _react=require("react");var _helpers=require("../helpers");var _NativeStripeSdk=_interopRequireDefault(require("../NativeStripeSdk"));var APPLE_PAY_NOT_SUPPORTED_MESSAGE='Apple pay is not supported on this device';function useStripe(){var _useState=(0,_react.useState)(false),_useState2=(0,_slicedToArray2.default)(_useState,2),isApplePaySupported=_useState2[0],setApplePaySupported=_useState2[1];(0,_react.useEffect)(function(){function checkApplePaySupport(){var isSupported;return _regenerator.default.async(function checkApplePaySupport$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(_helpers.isiOS!=null)){_context.next=4;break;}_context.t0=_helpers.isiOS;_context.next=7;break;case 4:_context.next=6;return _regenerator.default.awrap(_NativeStripeSdk.default.isApplePaySupported());case 6:_context.t0=_context.sent;case 7:isSupported=_context.t0;setApplePaySupported(isSupported);case 9:case"end":return _context.stop();}}},null,null,null,Promise);}checkApplePaySupport();},[]);var createPaymentMethod=(0,_react.useCallback)(function _callee(data){var options,paymentMethod,_args2=arguments;return _regenerator.default.async(function _callee$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:options=_args2.length>1&&_args2[1]!==undefined?_args2[1]:{};_context2.prev=1;_context2.next=4;return _regenerator.default.awrap(_NativeStripeSdk.default.createPaymentMethod(data,options));case 4:paymentMethod=_context2.sent;return _context2.abrupt("return",{paymentMethod:paymentMethod});case 8:_context2.prev=8;_context2.t0=_context2["catch"](1);return _context2.abrupt("return",{error:(0,_helpers.createError)(_context2.t0)});case 11:case"end":return _context2.stop();}}},null,null,[[1,8]],Promise);},[]);var retrievePaymentIntent=(0,_react.useCallback)(function _callee2(clientSecret){var paymentIntent;return _regenerator.default.async(function _callee2$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return _regenerator.default.awrap(_NativeStripeSdk.default.retrievePaymentIntent(clientSecret));case 3:paymentIntent=_context3.sent;return _context3.abrupt("return",{paymentIntent:paymentIntent});case 7:_context3.prev=7;_context3.t0=_context3["catch"](0);return _context3.abrupt("return",{error:(0,_helpers.createError)(_context3.t0)});case 10:case"end":return _context3.stop();}}},null,null,[[0,7]],Promise);},[]);var confirmPaymentMethod=(0,_react.useCallback)(function _callee3(paymentIntentClientSecret,data){var options,paymentIntent,_args4=arguments;return _regenerator.default.async(function _callee3$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:options=_args4.length>2&&_args4[2]!==undefined?_args4[2]:{};_context4.prev=1;_context4.next=4;return _regenerator.default.awrap(_NativeStripeSdk.default.confirmPaymentMethod(paymentIntentClientSecret,data,options));case 4:paymentIntent=_context4.sent;return _context4.abrupt("return",{paymentIntent:paymentIntent});case 8:_context4.prev=8;_context4.t0=_context4["catch"](1);return _context4.abrupt("return",{error:(0,_helpers.createError)(_context4.t0)});case 11:case"end":return _context4.stop();}}},null,null,[[1,8]],Promise);},[]);var presentApplePay=(0,_react.useCallback)(function _callee4(params){return _regenerator.default.async(function _callee4$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(isApplePaySupported){_context5.next=2;break;}return _context5.abrupt("return",{error:{code:_types.ApplePayError.Canceled,message:APPLE_PAY_NOT_SUPPORTED_MESSAGE}});case 2:_context5.prev=2;_context5.next=5;return _regenerator.default.awrap(_NativeStripeSdk.default.presentApplePay(params));case 5:return _context5.abrupt("return",{});case 8:_context5.prev=8;_context5.t0=_context5["catch"](2);return _context5.abrupt("return",{error:(0,_helpers.createError)(_context5.t0)});case 11:case"end":return _context5.stop();}}},null,null,[[2,8]],Promise);},[isApplePaySupported]);var updateApplePaySummaryItems=(0,_react.useCallback)(function _callee5(summaryItems){return _regenerator.default.async(function _callee5$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:if(isApplePaySupported){_context6.next=2;break;}return _context6.abrupt("return",{error:{code:_types.ApplePayError.Canceled,message:APPLE_PAY_NOT_SUPPORTED_MESSAGE}});case 2:_context6.prev=2;_context6.next=5;return _regenerator.default.awrap(_NativeStripeSdk.default.updateApplePaySummaryItems(summaryItems));case 5:return _context6.abrupt("return",{});case 8:_context6.prev=8;_context6.t0=_context6["catch"](2);return _context6.abrupt("return",{error:(0,_helpers.createError)(_context6.t0)});case 11:case"end":return _context6.stop();}}},null,null,[[2,8]],Promise);},[isApplePaySupported]);var confirmApplePayPayment=(0,_react.useCallback)(function _callee6(clientSecret){return _regenerator.default.async(function _callee6$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:if(isApplePaySupported){_context7.next=2;break;}return _context7.abrupt("return",{error:{code:_types.ApplePayError.Canceled,message:APPLE_PAY_NOT_SUPPORTED_MESSAGE}});case 2:_context7.prev=2;_context7.next=5;return _regenerator.default.awrap(_NativeStripeSdk.default.confirmApplePayPayment(clientSecret));case 5:return _context7.abrupt("return",{});case 8:_context7.prev=8;_context7.t0=_context7["catch"](2);return _context7.abrupt("return",{error:(0,_helpers.createError)(_context7.t0)});case 11:case"end":return _context7.stop();}}},null,null,[[2,8]],Promise);},[isApplePaySupported]);var handleCardAction=(0,_react.useCallback)(function _callee7(paymentIntentClientSecret){var paymentIntent;return _regenerator.default.async(function _callee7$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.prev=0;_context8.next=3;return _regenerator.default.awrap(_NativeStripeSdk.default.handleCardAction(paymentIntentClientSecret));case 3:paymentIntent=_context8.sent;return _context8.abrupt("return",{paymentIntent:paymentIntent});case 7:_context8.prev=7;_context8.t0=_context8["catch"](0);return _context8.abrupt("return",{error:(0,_helpers.createError)(_context8.t0)});case 10:case"end":return _context8.stop();}}},null,null,[[0,7]],Promise);},[]);var confirmSetupIntent=(0,_react.useCallback)(function _callee8(paymentIntentClientSecret,data){var options,setupIntent,_args9=arguments;return _regenerator.default.async(function _callee8$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:options=_args9.length>2&&_args9[2]!==undefined?_args9[2]:{};_context9.prev=1;_context9.next=4;return _regenerator.default.awrap(_NativeStripeSdk.default.confirmSetupIntent(paymentIntentClientSecret,data,options));case 4:setupIntent=_context9.sent;return _context9.abrupt("return",{setupIntent:setupIntent});case 8:_context9.prev=8;_context9.t0=_context9["catch"](1);return _context9.abrupt("return",{error:(0,_helpers.createError)(_context9.t0)});case 11:case"end":return _context9.stop();}}},null,null,[[1,8]],Promise);},[]);var createTokenForCVCUpdate=(0,_react.useCallback)(function _callee9(cvc){var tokenId;return _regenerator.default.async(function _callee9$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_context10.prev=0;_context10.next=3;return _regenerator.default.awrap(_NativeStripeSdk.default.createTokenForCVCUpdate(cvc));case 3:tokenId=_context10.sent;return _context10.abrupt("return",{tokenId:tokenId});case 7:_context10.prev=7;_context10.t0=_context10["catch"](0);return _context10.abrupt("return",{error:(0,_helpers.createError)(_context10.t0)});case 10:case"end":return _context10.stop();}}},null,null,[[0,7]],Promise);},[]);var handleURLCallback=(0,_react.useCallback)(function _callee10(url){var stripeHandled;return _regenerator.default.async(function _callee10$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:_context11.next=2;return _regenerator.default.awrap(_NativeStripeSdk.default.handleURLCallback(url));case 2:stripeHandled=_context11.sent;return _context11.abrupt("return",stripeHandled);case 4:case"end":return _context11.stop();}}},null,null,null,Promise);},[]);return{retrievePaymentIntent:retrievePaymentIntent,confirmPayment:confirmPaymentMethod,createPaymentMethod:createPaymentMethod,handleCardAction:handleCardAction,isApplePaySupported:isApplePaySupported,presentApplePay:presentApplePay,confirmApplePayPayment:confirmApplePayPayment,confirmSetupIntent:confirmSetupIntent,createTokenForCVCUpdate:createTokenForCVCUpdate,updateApplePaySummaryItems:updateApplePaySummaryItems,handleURLCallback:handleURLCallback};}
//# sourceMappingURL=useStripe.js.map